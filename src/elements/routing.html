<script src="../bower_components/page/page.js"></script>
<script src="../bower_components/socket.io-client/socket.io.js"></script>
<script>
    
    var project = {
        projectId: '340987612301',
        containerId: 'lalala',
        host: '192.168.99.100',
        ports: {
            '8000': '32772'
        },
        
        // MOCKKKK
        projectUrl: 'http://localhost:3000/code-machine/resources/marked/src/index.html',
    };

    function createNewProject(callback) {
        
        // mock
        setTimeout(function () {
            callback(project);
        }, 2000);
    }

    function loadProject(callback) {
        setTimeout(function () {
            callback(project);
        }, 1000);
    }
    
    window.addEventListener('WebComponentsReady', function() {
      
        console.log('routing started')

        // We use Page.js for routing. This is a Micro
        // client-side router inspired by the Express router
        // More info: https://visionmedia.github.io/page.js/
        page('/', function () {
            carbo.route = 'start';
        });
        
        page('/lab/:projectId', function (data) {
            carbo.route = 'lab'; 
            carbo.projectId = data.params.projectId;

            loadProject(function (project) {
                carbo.project = project;
            })
        });
        
        page('/new', function () {
            carbo.route = 'loading';
            
            createNewProject(function (project) {
                
                carbo.project = project;
                
                
                
                page('/lab/' + project.projectId);
            });
        });
    
        // add #! before urls
        page({
            hashbang: true
        });

    });
</script>
